<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Category: Tech Tips | Leaena.com</title>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="My name is Lindsey and I work as a full stack software engineer, currently getting my hands dirty with Python and JavaScript at Udacity. I wrote pretty frequently about my time at Hack Reactor, a soft">
<meta property="og:type" content="website">
<meta property="og:title" content="Leaena.com">
<meta property="og:url" content="http://leaena.github.io/categories/Tech-Tips/">
<meta property="og:site_name" content="Leaena.com">
<meta property="og:description" content="My name is Lindsey and I work as a full stack software engineer, currently getting my hands dirty with Python and JavaScript at Udacity. I wrote pretty frequently about my time at Hack Reactor, a soft">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Leaena.com">
<meta name="twitter:description" content="My name is Lindsey and I work as a full stack software engineer, currently getting my hands dirty with Python and JavaScript at Udacity. I wrote pretty frequently about my time at Hack Reactor, a soft">
  
    <link rel="alternative" href="/atom.xml" title="Leaena.com" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="../../css/style.css" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">Leaena.com</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://leaena.github.io"></form>
	</div>
</header>
    <div id="main">
      
  
    <article id="post-clojure-makes-me-feel-stupid" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/06/clojure-makes-me-feel-stupid/" class="article-date">
  <time datetime="2014-06-17T06:58:50.000Z" itemprop="datePublished">Jun 16 2014</time>
</a>
		</span>
		<span class="meta-elements author">Lindsey Smith</span>
		<div class="commentscount">
			
				<a href="http://leaena.github.io/2014/06/clojure-makes-me-feel-stupid/#disqus_thread" class="article-comment-link">Comments</a>
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/06/clojure-makes-me-feel-stupid/">Clojure Makes Me Feel Stupid</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>…but I’m kinda in love with it. Thanks to a friend/coworker I’m cautiously dipping my toe into the world of “functional programming”. I’m still not 100% certain I get the full gist of functional programming but, to my newb mind, I’d explain it as programming without consequences. Functions only depend on their inputs and external forces/state cannot muck with your function.</p>
<p>Apparently this makes it easier to predict what’s going on, but I still have issues reading what I just wrote. Parenthesis all the way down dudes. Also prefix notation is technically useful, but warping my poor little brain.</p>
<p>So 1 + 1 in Clojure is actually written as (+ 1 1). Makes sense, right? Sorta, except for the years and years of basic math classes that NEVER LOOKED LIKE THIS. Oh my brain. But it’s kinda cool that instead of 1 + 2 + 3 + 4 I only need to write (+ 1 2 3 4).</p>
<p>But seriously. This is a function in Clojure:</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="list">(<span class="title"><span class="built_in">defn</span></span> adder
  <span class="collection">[x y]</span>
  <span class="list">(<span class="title"><span class="built_in">+</span></span> x y)</span>)</span>

<span class="list">(<span class="title">adder</span><span class="number"> 3</span><span class="number"> 4</span>)</span> <span class="comment">;; 7&lt;/pre&gt;</span>
</pre></td></tr></table></figure>

<p>Wat? So the first line defines the function name. The second line is the parameters that you give to the function and then the last line adds those two parameters together. I then call the function on line 5 with the arguments 3 and 4 and then the semicolons denote comments and I use that do show what the output of the function is… 7.</p>
<p>As a super ridiculous aside. <strong>Parameters</strong> vs <strong>arguments</strong>? <strong>Parameters</strong> are the things that you define with the function. So x and y on line 2 are <strong>parameters</strong>. <strong>Arguments</strong> are what you pass to the function when you what to actually use it. So 3 and 4 on line 5 are <strong>arguments</strong>. Now go forth and be awesome!</p>
<p>So how do you be Clojure learners too? Currently I’m running through the <a href="https://github.com/ClojureBridge/curriculum" target="_blank" rel="external">clojurebridge curriculum</a> on my own.<a href="http://adambard.com/blog/clojure-in-15-minutes/" target="_blank" rel="external"> Clojure in 15 minutes</a> looks like a decent-y rundown of most of my syntax options. If you don’t want to put anything on your system yet, or just want to mess around with the syntax, there’s always <a href="http://tryclj.com/" target="_blank" rel="external">Try Clojure</a> which lets you program from your browser. And I’ve bookmarked <a href="http://www.braveclojure.com/" target="_blank" rel="external">Clojure for the Brave and True</a> mostly for the title, but I haven’t really read any of it yet.</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="">Tech Tips</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/clojure">clojure</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/functional-programming">functional programming</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-how-to-git-ignore-without-gitignore" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/03/how-to-git-ignore-without-gitignore/" class="article-date">
  <time datetime="2014-03-24T00:12:48.000Z" itemprop="datePublished">Mar 23 2014</time>
</a>
		</span>
		<span class="meta-elements author">Lindsey Smith</span>
		<div class="commentscount">
			
				<a href="http://leaena.github.io/2014/03/how-to-git-ignore-without-gitignore/#disqus_thread" class="article-comment-link">Comments</a>
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/03/how-to-git-ignore-without-gitignore/">How to Git Ignore without .gitignore</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>So I had this problem at work. I’m running a <code>virtualenv</code> instance on our main git repo for all my python packages. The global <code>.gitignore</code> obviously doesn’t know about it the way it knows to filter out node modules and other fun bits of localization and I sure as heck don’t want to add my own one line fix to the global <code>.gitignore</code> file.</p>
<p>So what’s a girl to do? Does she just ignore that one annoying untracked file line every time she does a <code>git status</code> from the terminal? Nope, she uses git exclude.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="variable">$GIT_DIR</span>/info/exclude
</pre></td></tr></table></figure>

<p>So for me this meant I had to create a <code>info</code> folder in my <code>.git</code> folder in the repo. Then I created a file called <code>exclude</code> (no file extension). The syntax in that file is exactly like the <code>.gitignore</code> file, it’s just very very local (to your computer and only for that repo).</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="">Tech Tips</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/git">git</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-advanced-filtering-with-angular-js" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/02/advanced-filtering-with-angular-js/" class="article-date">
  <time datetime="2014-02-07T00:49:28.000Z" itemprop="datePublished">Feb 6 2014</time>
</a>
		</span>
		<span class="meta-elements author">Lindsey Smith</span>
		<div class="commentscount">
			
				<a href="http://leaena.github.io/2014/02/advanced-filtering-with-angular-js/#disqus_thread" class="article-comment-link">Comments</a>
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/02/advanced-filtering-with-angular-js/">Advanced Filtering with Angular.js</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Everyone (who’s used angular or seen an angular tutorial) has seen the awesome realtime angular search. This is used with a filter property, but there are more complex things you can use with filtering. On my Hack Reactor <a href="http://github.com/leaena/blogmark" target="_blank" rel="external">hackathon project</a> I used filtering for just about everything. From picking out individual objects to finding just the right combinations and I learned some awesome tricks and some pitfalls to avoid.</p>
<p>One of the coolest things you can do is filter by lots of things together. The filter ends up looking a lot like a JavaScript object:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>filter:{TEXT: text, notes: noted, category: category}
</pre></td></tr></table></figure>

<p>They way this works the best is if you have a number of searches all on one page to pull together. Say a regular text search (<code>text</code> above) that needs to interact with a drop down menu filter (<code>category</code>). Just throw all the variables into one object and filter on that.</p>
<p>Another neat thing you can do is filter by IDs. For example, if you want to have individual pages for each item, you can normally just call to it based on the $index of that item. But what if you have searched and filtered your list of data into a more manageable grouping? Index doesn’t work! It’s pulling the index of the new filtered list and not the actual index that data point has in the entire data structure.</p>
<p>My fun work around for this was to send the object that you had selected to a function within my Angular controller for that page and find the data that way.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>$scope.add = <span class="function"><span class="keyword">function</span><span class="params">(website)</span>{</span>
    $rootScope.selected = $rootScope.selected || [];
    <span class="keyword">if</span>($rootScope.selected.indexOf(website) === -<span class="number">1</span>){
        $rootScope.selected.push(website);
    }
};
</pre></td></tr></table></figure>

<p>Of course this requires something in the <code>$rootScope</code>, but that also benefited me because I wanted to have access on a separate page to all of the data points a user chose. That way I could fill out a detailed report of the chosen bookmarks with user defined notes all on one screen.</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="">Tech Tips</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/angular">angular</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-web-scraping-science" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/01/web-scraping-science/" class="article-date">
  <time datetime="2014-01-31T23:16:49.000Z" itemprop="datePublished">Jan 31 2014</time>
</a>
		</span>
		<span class="meta-elements author">Lindsey Smith</span>
		<div class="commentscount">
			
				<a href="http://leaena.github.io/2014/01/web-scraping-science/#disqus_thread" class="article-comment-link">Comments</a>
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/01/web-scraping-science/">Custom APIs and Web Scraping for Science</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>So my team’s most recent application, Helix, involved genome visualization. We integrated it with the <a href="http://23andme.com" target="_blank" rel="external">23andme</a> API, but still needed a way to find out interesting information about specific RSIDs (used by researchers and databases to refer to specific base pairs of DNA). By far the most useful and open source repository of genetic information is <a href="http://snpedia.org" target="_blank" rel="external">SNPedia</a>, but I needed access to lots of information and to integrate calls to specific SNPs. Basically I needed an API. So being ever resourceful, I decided to make my own.</p>
<p>Tools for the task were an easy choice. I needed a small fast server that I could implement a web scrapper on. I have always wanted a reason to use <a href="http://www.crummy.com/software/BeautifulSoup/" target="_blank" rel="external">BeautifulSoup</a>, but it’s a Python library so I knew it would be easier to build a Python server to run the API endpoints. I chose <a href="http://flask.pocoo.org/" target="_blank" rel="external">Flask</a> because of its lightweight nature and how much it reminds me of a Node/Express server at times.</p>
<p>Thankfully there are some really good tutorials for both Flask and BeautifulSoup, my favorites (and the ones I referenced when I hit weirdness) were <a href="http://blog.miguelgrinberg.com/post/designing-a-restful-api-with-python-and-flask" target="_blank" rel="external">Designing a RESTful API</a> and <a href="http://www.briancarpio.com/2012/12/02/website-scraping-with-python-and-beautiful-soup/" target="_blank" rel="external">Website Scraping with BeautifulSoup</a>. Both of these tutorials said a lot of things better than I could have myself.</p>
<p>For access to my SNPedia API and information on how to use it, <a href="https://github.com/leaena/snp-api" target="_blank" rel="external">check out my project on GitHub</a>.</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="">Tech Tips</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/API">API</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/BeautifulSoup">BeautifulSoup</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/DNA">DNA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/SNP">SNP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/flask">flask</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/python">python</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-d3-js-rollups" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/01/d3-js-rollups/" class="article-date">
  <time datetime="2014-01-05T02:28:17.000Z" itemprop="datePublished">Jan 4 2014</time>
</a>
		</span>
		<span class="meta-elements author">Lindsey Smith</span>
		<div class="commentscount">
			
				<a href="http://leaena.github.io/2014/01/d3-js-rollups/#disqus_thread" class="article-comment-link">Comments</a>
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/01/d3-js-rollups/">D3.js Rollups</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Do you have all the data and none of the visuals? Do you just want a pretty, fast way to compare lots of data that centers around maybe just a handful of moments?</p>
<p><a href="http://d3js.org/" target="_blank" rel="external">D3.js</a> can help you tame all of your data and <code>d3.rollup</code> is especially useful if you have lots of data that you need to combine into just a couple of data points. All it takes is a couple of (pretty long) lines of code and you will have an awesome visual that’s very customizable.</p>
<p>Lets start with a really straightforward example of a rollup. In all of these examples, I’m using code straight from my HeatVote project, which requires me to pull voting data from our server API that I receive as a <a href="http://jsonblob.com/" target="_blank" rel="external">JSON blob</a>. Here’s an example entry:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>{ video_id: <span class="string">'T-D1KVIuvjA'</span>,
  timestamp: <span class="number">2</span>,
  vote: <span class="number">1</span>,
  id: <span class="number">1</span>,
  createdAt: Sat Dec <span class="number">21</span> <span class="number">2013</span> <span class="number">14</span>:<span class="number">55</span>:<span class="number">42</span> GMT-<span class="number">0800</span> (PST),
  updatedAt: Sat Dec <span class="number">21</span> <span class="number">2013</span> <span class="number">14</span>:<span class="number">55</span>:<span class="number">42</span> GMT-<span class="number">0800</span> (PST) }
</pre></td></tr></table></figure>

<p>Now obviously there are a bunch of these, and technically there are easier ways to do this, but to show off the structure of a rollup, lets count how many entries we had in our database using a d3 rollup!</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="keyword">var</span> total = d3.nest()
  .rollup(<span class="function"><span class="keyword">function</span><span class="params">(d)</span>{</span>
    <span class="keyword">return</span> d.length;
  })
  .entries(data);
</pre></td></tr></table></figure><br>Remember, <code>data</code> here is my array of JSON entries, so in our rollup function the <code>d</code> is just shorthand for all of the data. This isn’t a very interesting example though, lets take a look at something that really shows off the beauty of a d3 rollup.<br><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="keyword">var</span> averages = d3.nest()
  .key(<span class="function"><span class="keyword">function</span><span class="params">(d)</span> {</span>
    <span class="keyword">return</span> d.timestamp;
  })
  .sortKeys(d3.ascending)
  .rollup(<span class="function"><span class="keyword">function</span><span class="params">(d)</span>{</span>
    <span class="keyword">return</span> d3.mean(d, <span class="function"><span class="keyword">function</span><span class="params">(g)</span> {</span>
      <span class="keyword">return</span> +g.vote;
    });
   })
   .entries(data);
</pre></td></tr></table></figure>

<p>Now there is a <strong>lot</strong> going on in this very compact few lines, so well go through them one by one, but the result is that <code>averages</code> is equal to an array of objects with the properties <code>key</code> (that is equal to each unique timestamp) and <code>value</code> (that is equal to the mean of all votes at that timestamp).</p>
<p>So lets break it down:</p>
<ul>
<li><code>.key(...)</code> is just used to tell the function what our keys are, only grabbing unique values of that property.</li>
<li><code>.sortKeys</code> is just a prettiness thing, it sorts my keys into an order (when they’re pulled off the server the only order is by the time they were created on the database).</li>
<li>and finally our lovely <code>.rollup(...)</code>. Now instead of d being an array of the whole data, it’s now an array of only the data for each individual key (so all of the data with the same timestamp). The inner function <code>d3.mean</code> takes a specific property from all of the data for each key and averages them up.<br>And that, is d3 rollup in a nutshell, it’s really lovely at coercing relationships out of your raw data and you can obviously do a lot more with it that just averaging things. The <a href="https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_nest" target="_blank" rel="external">d3 nest docs</a> are probably the next best place to look to get your hands dirty (.rollup is a property of nest).</li>
</ul>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="">Tech Tips</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/d3">d3</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/data-sci">data sci</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/javascript">javascript</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-cloud-postgresql-servers-with-heroku" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2013/12/cloud-postgresql-servers-with-heroku/" class="article-date">
  <time datetime="2013-12-30T19:00:08.000Z" itemprop="datePublished">Dec 30 2013</time>
</a>
		</span>
		<span class="meta-elements author">Lindsey Smith</span>
		<div class="commentscount">
			
				<a href="http://leaena.github.io/2013/12/cloud-postgresql-servers-with-heroku/#disqus_thread" class="article-comment-link">Comments</a>
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2013/12/cloud-postgresql-servers-with-heroku/">Cloud PostgreSQL Servers with Heroku</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>While it might be possible that I’m the only person out there who didn’t want to hassle with creating a <a href="http://www.postgresql.org/" target="_blank" rel="external">Postgres</a> database on my computer that needed to be passed around to my project-mates, I have a feeling there is one lost soul in the universe besides me who might find this useful. When I first tried to use <a href="https://www.heroku.com/postgres" target="_blank" rel="external">Heroku’s PostgreSQL database add-on</a> the only documentation I really found was for attaching it to existing Heroku apps. I just wanted a dev environment and currently don’t have plans to deploy the app with Heroku so I just wanted to “borrow” their free level of database storage.</p>
<p>It is shockingly easy. All I needed to do was log in to my Heroku dashboard and click the databases tab. From there I created a new database (be sure to choose the almost hidden <code>Dev Plan (free)</code> option on the lower left). Once it was done spinning up if you click on it, you are taken to a page with all the login info you could ever need:</p>
<p><img src="http://res.cloudinary.com/leaena/image/upload/v1391709364/Screen-Shot-2013-12-30-at-10_41_21-AM_vpd5hf.png" alt="Heroku Postgres Login Stuffs"></p>
<p>I just plugged all of that info into Sequelize (<a href="http://leaena.com/2013/12/setting-up-a-database-node-module-on-a-nodeexpress-server-with-sequelize/" title="Setting Up a Database Node Module on a Node/Express Server with Sequelize" target="_blank" rel="external">see my previous post</a>), because I’m using Heroku Postgres, I had to make sure I used the pg.native options in both Node and Sequelize.</p>
<p>A few caveats! For a Mac, if you just install the Postgres standalone app from <a href="http://postgresql.org/" target="_blank" rel="external">PostgreSQL</a>, life will not be pleasant (I learned this the hard way). The easiest way to make life happy is to use Homebrew to install Postgres. <a href="http://brew.sh/" target="_blank" rel="external">Please have Homebrew</a>, it makes life super easy. All you need to do then is <code>brew install postgresql</code>.</p>
<p>The second awesome thing about Heroku Postgres is that although I’m only on the free version, I can still easily log in to my database from the command line and change things. On the page with the connection info, click the double arrows on the right and choose URL. Now, in Terminal type <code>psql DATABASE_URL_HERE</code> and voila! direct access to your database.</p>
<p><a href="http://leaena.com/wp-content/uploads/2013/12/Screen-Shot-2013-12-30-at-10.41.33-AM.png" target="_blank" rel="external"><img src="http://res.cloudinary.com/leaena/image/upload/v1391709372/Screen-Shot-2013-12-30-at-10_41_33-AM-200x300_p4qzvm.png" alt=""></a></p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="">Tech Tips</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Heroku">Heroku</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/PostgreSQL">PostgreSQL</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-setting-up-a-database-node-module-on-a-nodeexpress-server-with-sequelize" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2013/12/setting-up-a-database-node-module-on-a-nodeexpress-server-with-sequelize/" class="article-date">
  <time datetime="2013-12-30T01:17:28.000Z" itemprop="datePublished">Dec 29 2013</time>
</a>
		</span>
		<span class="meta-elements author">Lindsey Smith</span>
		<div class="commentscount">
			
				<a href="http://leaena.github.io/2013/12/setting-up-a-database-node-module-on-a-nodeexpress-server-with-sequelize/#disqus_thread" class="article-comment-link">Comments</a>
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2013/12/setting-up-a-database-node-module-on-a-nodeexpress-server-with-sequelize/">Setting Up a Database Node Module on a Node/Express Server with Sequelize</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>If you just need to get a node server up and running with very few lines of code then you hopefully already know about <a href="http://nodejs.org/" target="_blank" rel="external">Node</a>/<a href="http://expressjs.com/" target="_blank" rel="external">Express</a> (if you don’t, the Express website has <a href="http://expressjs.com/guide.html" target="_blank" rel="external">a pretty good intro tutorial</a> and has <a href="http://expressjs.com/api.html#app.use" target="_blank" rel="external">good documentation to get started serving up static assets</a>). If you need all of that and to be able to route queries to a database quickly and easily then you might not know about the awesome power of <a href="http://sequelizejs.com/" target="_blank" rel="external">Sequelize</a>.</p>
<p>If you haven’t messed around with a ORM (<a href="http://en.wikipedia.org/wiki/Object-relational_mapping" target="_blank" rel="external">Object Relational Mapper</a>, a program that maps your code to a database) before, Sequelize is a really straight forward one to start with.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="keyword">var</span> voteTable = sequelize.define(<span class="string">'vote'</span>, {
  video_id: Sequelize.STRING,
  timestamp: Sequelize.INTEGER,
  vote: Sequelize.INTEGER
});

voteTable.sync();
</pre></td></tr></table></figure>

<p>Once I had my server set up (and installed the sequelize dependencies). This was the line of code I needed to use to create a new table for my current group project. Sequelize automatically includes extra columns like unique id and created at/updated at timestamps (there are ways to tell it not to too).</p>
<p>The rest of the initial set up is easy too, but it’s well documented over in the Sequelize docs. The fun part comes when you can start to make your database more modular. The first thing I did was to take out the actual username/password information from my database connection. I stored them as an object in a separate JavaScript file (so I could add it to <a href="https://help.github.com/articles/ignoring-files" target="_blank" rel="external">.gitignore</a> and not share my passwords with the world).</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="comment">//module.exports allows us to use this code in other places as a node module,</span>
<span class="comment">//we'll see it again when I make the database calls modular</span>
module.exports = {
  database: <span class="string">'database_name'</span>,
  username: <span class="string">'username'</span>,
  password: <span class="string">'secret_password'</span>,
  host: <span class="string">'host_url'</span>,
  port: <span class="number">5432</span>,
  dialect: <span class="string">'postgres'</span>, <span class="comment">//obviously you don't have to use PostgreSQL</span>
  native: <span class="literal">true</span> <span class="comment">//required for Heroku Postgres (I'll cover that in another post)</span>
};
</pre></td></tr></table></figure>

<p>I saved that snipped to a file called <code>db_config.js</code> at the root directory and then created my main database module in the subfolder <code>/controller/</code> called <code>database.js</code>. So to have access to the private config object, all I need to do is set up my dependencies, import the <code>db_config</code> file, and I can start using my config variables to connect to my database:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="keyword">var</span> Sequelize = <span class="built_in">require</span>(<span class="string">'sequelize'</span>);
<span class="keyword">var</span> pg = <span class="built_in">require</span>(<span class="string">'pg'</span>).native; <span class="comment">//again this line is specific to using a Postgres database</span>
<span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'../db_config'</span>);

<span class="keyword">var</span> sequelize = <span class="keyword">new</span> Sequelize(config.database, config.username, config.password, {
  host: config.host,
  port: config.port,
  dialect: config.dialect,
  native: config.native <span class="comment">//Heroku Postgress again</span>
});
</pre></td></tr></table></figure><br>Now between that code and my creating a table I have full access to a database, but now I need to get this all into my main <code>app.js</code> simple server I created with Node/Express. This is a super easy leap. First I create my functions to send and retrieve data in <code>/controller/database.js</code>:<br><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>module.exports.createVote = <span class="function"><span class="keyword">function</span><span class="params">(req, res)</span>{</span>
  <span class="comment">//code to bundle up the created object and save it do the database</span>
};

module.exports.getVotes = <span class="function"><span class="keyword">function</span><span class="params">(req, res)</span>{</span>
  <span class="comment">//code to find votes based on specific requests from the user</span>
};
</pre></td></tr></table></figure>

<p>Now to have access to these functions (which are a part of the <code>database.js</code> node module, thanks to the module.exports object which is <a href="http://nodejs.org/api/modules.html#modules_the_module_object" target="_blank" rel="external">a feature of Node</a>) I only need to require <code>database.js</code> in my main server app and call the functions where I need them:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="keyword">var</span> database = <span class="built_in">require</span>(<span class="string">'./controllers/database'</span>);

<span class="comment">//many lines later</span>
app.post(<span class="string">'/votes'</span>, database.createVote);
app.get(<span class="string">'/votes/:vidID'</span>, database.getVotes);
</pre></td></tr></table></figure>

<p>The <code>/votes/:vidID</code> is a <a href="http://expressjs.com/api.html#app.param" target="_blank" rel="external">handy trick of Express</a> to pass information to the server. The value gets attached to the <code>req.param.vidID</code> property so I can use it when I request specific information from the server. For example if I wanted to query for results from a video ID of 123 I would send a post request to <code>/votes/123</code> and then my <code>req.param.vidID === 123</code>.</p>
<p>One last trick, in Sequelize when you query the database you get back quite a few more rows than you might expect. When I query my <code>voteTable</code> (the one I only explicitly created three columns for?) I get back something that looks like this monster:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="code"><pre>{ dataValues:
     { video_id: <span class="string">'7QBgK0_RbkE'</span>, timestamp: <span class="number">2</span>, vote: <span class="number">1</span>, id: <span class="number">192</span>,
       createdAt: Sun Dec <span class="number">22</span> <span class="number">2013</span> <span class="number">22</span>:<span class="number">19</span>:<span class="number">33</span> GMT-<span class="number">0800</span> (PST),
       updatedAt: Sun Dec <span class="number">22</span> <span class="number">2013</span> <span class="number">22</span>:<span class="number">19</span>:<span class="number">33</span> GMT-<span class="number">0800</span> (PST) },
    __options:
     { timestamps: <span class="literal">true</span>, createdAt: <span class="string">'createdAt'</span>, updatedAt: <span class="string">'updatedAt'</span>,
       deletedAt: <span class="string">'deletedAt'</span>, touchedAt: <span class="string">'touchedAt'</span>, instanceMethods: {}, classMethods: {},
       validate: {}, freezeTableName: <span class="literal">false</span>, underscored: <span class="literal">false</span>, syncOnAssociation: <span class="literal">true</span>,
       paranoid: <span class="literal">false</span>, whereCollection: [<span class="built_in">Object</span>], schema: <span class="literal">null</span>, schemaDelimiter: <span class="string">''</span>,
       language: <span class="string">'en'</span>, defaultScope: <span class="literal">null</span>, scopes: <span class="literal">null</span>, hooks: [<span class="built_in">Object</span>], omitNull: <span class="literal">false</span>,
       hasPrimaryKeys: <span class="literal">false</span> },
    hasPrimaryKeys: <span class="literal">false</span>,
    selectedValues:
     { video_id: <span class="string">'7QBgK0_RbkE'</span>, timestamp: <span class="number">2</span>, vote: <span class="number">1</span>, id: <span class="number">192</span>,
       createdAt: Sun Dec <span class="number">22</span> <span class="number">2013</span> <span class="number">22</span>:<span class="number">19</span>:<span class="number">33</span> GMT-<span class="number">0800</span> (PST),
       updatedAt: Sun Dec <span class="number">22</span> <span class="number">2013</span> <span class="number">22</span>:<span class="number">19</span>:<span class="number">33</span> GMT-<span class="number">0800</span> (PST) },
    __eagerlyLoadedAssociations: [],
    isDirty: <span class="literal">false</span>,
    isNewRecord: <span class="literal">false</span>,
    daoFactoryName: <span class="string">'votes'</span>,
    daoFactory:
     { options: [<span class="built_in">Object</span>], name: <span class="string">'votes'</span>, tableName: <span class="string">'votes'</span>, rawAttributes: [<span class="built_in">Object</span>],
       daoFactoryManager: [<span class="built_in">Object</span>], associations: {}, scopeObj: {}, primaryKeys: {},
       primaryKeyCount: <span class="number">0</span>, hasPrimaryKeys: <span class="literal">false</span>, autoIncrementField: <span class="string">'id'</span>, DAO: [<span class="built_in">Object</span>] }
 }
</pre></td></tr></table></figure>

<p>And that’s just <strong>ONE</strong> entry in the database! To fix that add an option to your sequelize query: <code>{raw: true}</code> so the query would look like:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>voteTable.findAll(query, {raw: <span class="literal">true</span>})
</pre></td></tr></table></figure>

<p>And one entry of output would be:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>{ video_id: <span class="string">'T-D1KVIuvjA'</span>,
  timestamp: <span class="number">2</span>,
  vote: <span class="number">1</span>,
  id: <span class="number">1</span>,
  createdAt: Sat Dec <span class="number">21</span> <span class="number">2013</span> <span class="number">14</span>:<span class="number">55</span>:<span class="number">42</span> GMT-<span class="number">0800</span> (PST),
  updatedAt: Sat Dec <span class="number">21</span> <span class="number">2013</span> <span class="number">14</span>:<span class="number">55</span>:<span class="number">42</span> GMT-<span class="number">0800</span> (PST) }
</pre></td></tr></table></figure>

<p>That is enough database tricks for today. If you want to just stare at my code for a while to create &amp; retrieve votes from our database you can find <a href="https://gist.github.com/leaena/8174127" target="_blank" rel="external">my gist here</a> (with sanitized login info for the db_config). The real (still being modded by the team) code is <a href="https://github.com/leaena/videoheatmap" target="_blank" rel="external">forked on my GitHub</a>. I have a few more of these in the works from my adventures slinging code and I hope to post a few more before Hack Reactor starts back up and I lose all free time again.</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="">Tech Tips</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/express">express</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/javascript">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/nodejs">nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/sequelize">sequelize</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
  

    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:leaena.github.io">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">Leaena.com</a>
	</h1>
	<span class="copyright">
		&copy; 2014 Lindsey Smith<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    
<script>
  var disqus_shortname = 'leaena';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="../../js/script.js" type="text/javascript"></script>
  </div>
</body>
</html>